pool:
  name: mypool
  agent: myagent

steps:
  - task: Maven@3
    inputs:
      mavenPomFile: 'pom.xml'  # Path to your Maven POM file
      goals: 'clean test'  # Specify Maven goals, e.g., clean and test
      options: '-Dsurefire.suiteXmlFiles=src/test/resources/TestSuite.xml'
    continueOnError: true

  - task: PublishTestResults@2
    inputs:
      testResultsFiles: 'test-output/testng-results.xml'  # Adjust the file pattern to match your TestNG XML reports
      testRunTitle: 'TestNG Test Run'  # Optionally, provide a title for the test run
      testConfiguration: 'Development'  # Optionally, specify a test configuration
      testPlatform: 'Java'  # Optionally, specify the test platform
      publishRunAttachments: false  # Optionally, publish attachments like screenshots, if any
    displayName: 'Publish TestNG Test Results'

  - powershell: |
      Get-ChildItem -Path "$(Agent.WorkFolder)"
    displayName: 'List Contents of Folder'

  - task: DeleteFiles@1
    inputs:
      SourceFolder: '$(Agent.WorkFolder)'
      Contents: '**'
      CleanTargetFolder: true
    displayName: 'Delete all files from _work directory'
    continueOnError: true

  - powershell: |
      Get-ChildItem -Path "$(Agent.WorkFolder)"
    displayName: 'List Contents of Folder'